---
title: "安裝 Dify"
description: "Dify 是一個開源的 LLM 應用開發平台。他提供了從 Agent 建置到 AI workflow 、 RAG 檢索、模型管理等能力，輕鬆建置和營運生成式 AI 原生應用程式，因為更佳的視覺化，所以對於 AI 新手來說，會比 LangChain 更容易來的使用。"
pubDate: 2025-01-11
heroImage: "https://images.unsplash.com/photo-1499750310107-5fef28a66643?w=1200&h=630&fit=crop"
---


Dify 是一個開源的 LLM 應用開發平台。他提供了從 Agent 建置到 AI workflow 、 RAG 檢索、模型管理等能力，輕鬆建置和營運生成式 AI 原生應用程式，因為更佳的視覺化，所以對於 AI 新手來說，會比 LangChain 更容易來的使用。

<!--more-->

這篇文章會示範，如何快速的在 AWS EC2 上面啟一個 Dify 平台，來快速驗證 AI 應用。

## 前置需求

1. 一個運行的 EC2 instance (建議至少 t3.large)

3. 已設定的域名指向 EC2 的 IP (這裡以 ai.ericwu.asia 作爲範例)

## 步驟 1: 安裝必要套件

```
# 更新系統
sudo apt update
sudo apt upgrade -y

# 安裝 Docker (如果尚未安裝)
curl -fsSL https://get.docker.com -o get-docker.sh
sudo sh get-docker.sh

# 安裝 Docker Compose
sudo apt install docker-compose -y

# 安裝 Nginx
sudo apt install nginx -y
```

## 步驟 2: 設定 Nginx

建立 Nginx 設定文件：

```
sudo nano /etc/nginx/sites-available/dify
```

加入以下設定：

```
# 前端設定
server {
    listen 80;
    server_name ai.ericwu.asia;

    location / {
        proxy_pass http://localhost:8080;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        
        add_header 'Access-Control-Allow-Origin' 'https://ai.ericwu.asia';
        add_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS, PUT, DELETE';
        add_header 'Access-Control-Allow-Headers' '*';
        add_header 'Access-Control-Allow-Credentials' 'true';
    }
}

# 後端設定
server {
    listen 80;
    server_name api.ericwu.asia;

    location /api/ {
        proxy_pass http://localhost:8080;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;

        add_header 'Access-Control-Allow-Origin' 'https://ai.ericwu.asia';
        add_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS, PUT, DELETE';
        add_header 'Access-Control-Allow-Headers' '*';
        add_header 'Access-Control-Allow-Credentials' 'true';
    }
}
```

啟用設定：

```
sudo ln -s /etc/nginx/sites-available/dify /etc/nginx/sites-enabled/
sudo nginx -t
sudo systemctl restart nginx
```

## 步驟 3: 設定 SSL 證書

使用 Certbot 安裝 SSL 證書：

```
sudo apt install certbot python3-certbot-nginx -y
sudo certbot --nginx -d ai.ericwu.asia
```

## 步驟 4: 下載並設定 Dify

```
# 抓下 Dify 的程式碼
git clone https://github.com/langgenius/dify.git
cd dify/dock

# 複製範例設定文件
cp .env.example .env
```

## 步驟 5: 修改 .env 文件

編輯 .env 文件，設定以下重要參數：

```

CONSOLE_API_URL=https://ai.ericwu.asia
CONSOLE_WEB_URL=https://ai.ericwu.asia
SERVICE_API_URL=https://ai.ericwu.asia
APP_API_URL=https://ai.ericwu.asia
APP_WEB_URL=https://ai.ericwu.asia
```

## 步驟 6: 啟動 Dify

```
# 啟動服務
sudo docker-compose up -d
```

## 步驟 7: 驗證安裝

使用瀏覽器去到 https://ai.ericwu.asia/ 確認前端可以正常訪問。如果可以的話，就可以建立管理員帳號了！
